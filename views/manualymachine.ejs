<!DOCTYPE html>
<html>
  <head>
    <%- include('./partials/head'); %>
    <style>
      .tab-buttons {
        display: flex;
        flex-wrap: wrap;
        gap: 10px;
        margin-bottom: 20px;
      }

      .tab-buttons button {
        padding: 10px 20px;
        border: none;
        background-color: #f1f1f1;
        cursor: pointer;
        font-weight: bold;
        border-radius: 5px;
      }

      .tab-buttons button.active {
        background-color: #007bff;
        color: white;
      }

      .tab-content {
        display: none;
        padding: 20px;
        border: 1px solid #dee2e6;
        border-radius: 5px;
        background-color: #f8f9fa;
      }

      .tab-content.active {
        display: block;
      }
    </style>
  </head>
  <body>
    <div class="wrapper">
      <%- include('./partials/header'); %>

      <div class="container">
  <div class="page-inner">
    <div class="pt-2 pb-4">
      <h3 class="fw-bold mb-3">Hapus Data</h3>
      <p>Silakan pilih salah satu menu hapus data di bawah ini:</p>
    </div>

    <!-- Tombol Tab -->
    <div class="tab-buttons mb-4">
      <button class="tab-btn active" data-target="verval">Hapus Verval</button>
      <button class="tab-btn" data-target="erdkk">Hapus ERDKK</button>
      <button class="tab-btn" data-target="do">Hapus Penyaluran DO</button>
      <button class="tab-btn" data-target="wcm">Hapus WCM</button>
    </div>

    <!-- Konten Delete -->
    <div id="verval" class="tab-content active">
      <h5>Hapus Data Verval</h5>
      <ol>
        <li>Masukkan bulan dan tahun. Kabupaten boleh kosong.</li>
      </ol>
      <p class="text-danger">Wilayah wajib diisi</p>
      <div class="grid grid-cols-2 items-center gap-2">
        <label for="manajer-verval" class="text-sm font-medium text-gray-700">Wilayah</label>
        <select id="manajer-verval" class="filter-dropdown border border-gray-300 rounded-lg shadow-sm p-2 h-[40px] w-full">
          <option value="">Pilih Wilayah</option>
          <option value="JATENG1">JATENG 1</option>
          <option value="JATENG2">JATENG 2</option>
          <option value="DIYJATENG3">DIY & JATENG 3</option>
          <option value="JATENG4">JATENG 4</option>
        </select>
      </div>

      <div class="grid grid-cols-2 items-center gap-2">
        <label for="tahun-verval" class="text-sm font-medium text-gray-700">Tahun</label>
        <select id="tahun-verval" class="filter-dropdown border border-gray-300 rounded-lg shadow-sm p-2 h-[40px] w-full">
          <option value="">Pilih Tahun</option>
          <option value="2024">2024</option>
          <option value="2025">2025</option>
        </select>
      </div>

      <div class="grid grid-cols-2 items-center gap-2 mt-2">
        <label for="bulan-verval" class="text-sm font-medium text-gray-700">Bulan</label>
        <select id="bulan-verval" class="filter-dropdown border border-gray-300 rounded-lg shadow-sm p-2 h-[40px] w-full">
          <option value="">Pilih Bulan</option>
          <option value="1">Januari</option>
          <option value="2">Februari</option>
          <option value="3">Maret</option>
          <option value="4">April</option>
          <option value="5">Mei</option>
          <option value="6">Juni</option>
          <option value="7">Juli</option>
          <option value="8">Agustus</option>
          <option value="9">September</option>
          <option value="10">Oktober</option>
          <option value="11">November</option>
          <option value="12">Desember</option>
        </select>
      </div>

      <div class="grid grid-cols-2 items-center gap-2 mt-2">
        <label for="kabupaten-verval" class="text-sm font-medium text-gray-700">Kabupaten</label>
        <select id="kabupaten-verval" class="filter-dropdown border border-gray-300 rounded-lg shadow-sm p-2 h-[40px] w-full">
          <option value="">Semua Kabupaten</option>
          <option value="BANJARNEGARA">BANJARNEGARA</option>
          <option value="BANYUMAS">BANYUMAS</option>
          <option value="BATANG">BATANG</option>
          <option value="BLORA">BLORA</option>
          <option value="BOYOLALI">BOYOLALI</option>
          <option value="BREBES">BREBES</option>
          <option value="CILACAP">CILACAP</option>
          <option value="DEMAK">DEMAK</option>
          <option value="GROBOGAN">GROBOGAN</option>
          <option value="JEPARA">JEPARA</option>
          <option value="KARANGANYAR">KARANGANYAR</option>
          <option value="KEBUMEN">KEBUMEN</option>
          <option value="KENDAL">KENDAL</option>
          <option value="KLATEN">KLATEN</option>
          <option value="KUDUS">KUDUS</option>
          <option value="MAGELANG">MAGELANG</option>
          <option value="PATI">PATI</option>
          <option value="PEKALONGAN">PEKALONGAN</option>
          <option value="PEMALANG">PEMALANG</option>
          <option value="PURBALINGGA">PURBALINGGA</option>
          <option value="PURWOREJO">PURWOREJO</option>
          <option value="REMBANG">REMBANG</option>
          <option value="SEMARANG">SEMARANG</option>
          <option value="SRAGEN">SRAGEN</option>
          <option value="SUKOHARJO">SUKOHARJO</option>
          <option value="TEGAL">TEGAL</option>
          <option value="TEMANGGUNG">TEMANGGUNG</option>
          <option value="WONOGIRI">WONOGIRI</option>
          <option value="WONOSOBO">WONOSOBO</option>
          <option value="KOTA MAGELANG">KOTA MAGELANG</option>
          <option value="KOTA PEKALONGAN">KOTA PEKALONGAN</option>
          <option value="KOTA SALATIGA">KOTA SALATIGA</option>
          <option value="KOTA SEMARANG">KOTA SEMARANG</option>
          <option value="KOTA SURAKARTA">KOTA SURAKARTA</option>
          <option value="KOTA TEGAL">KOTA TEGAL</option>
          <option value="BANTUL">BANTUL</option>
          <option value="KOTA YOGYAKARTA">KOTA YOGYAKARTA</option>
          <option value="SLEMAN">SLEMAN</option>
          <option value="KULON PROGO">KULON PROGO</option>
          <option value="GUNUNG KIDUL">GUNUNG KIDUL</option>
        </select>
      </div>

      <div class="d-flex flex-column gap-2 mt-4">
        <button type="button" class="btn btn-danger" data-jenis="verval">Hapus Data Verval</button>
      </div>
    </div>

    <div id="erdkk" class="tab-content">
      <h5>Hapus Data ERDKK</h5>
      <p class="text-muted">Fitur ini belum aktif.</p>
    </div>

    <div id="do" class="tab-content">
      <h5>Hapus Data Penyaluran DO</h5>
      <ol>
        <li>Masukkan bulan dan tahun. Kabupaten boleh kosong.</li>
      </ol>
<p class="text-danger">Wilayah wajib diisi</p>
    <div class="grid grid-cols-2 items-center gap-2">
        <label for="manajer-penyalurando" class="text-sm font-medium text-gray-700">Wilayah</label>
        <select id="manajer-penyalurando" class="filter-dropdown border border-gray-300 rounded-lg shadow-sm p-2 h-[40px] w-full">
          <option value="">Pilih Wilayah</option>
          <option value="JATENG1">JATENG 1</option>
          <option value="JATENG2">JATENG 2</option>
          <option value="DIYJATENG3">DIY & JATENG 3</option>
          <option value="JATENG4">JATENG 4</option>
        </select>
      </div>

      <div class="grid grid-cols-2 items-center gap-2">
        <label for="tahun-penyalurando" class="text-sm font-medium text-gray-700">Tahun</label>
        <select id="tahun-penyalurando" class="filter-dropdown border border-gray-300 rounded-lg shadow-sm p-2 h-[40px] w-full">
          <option value="">Pilih Tahun</option>
          <option value="2024">2024</option>
          <option value="2025">2025</option>
        </select>
      </div>

      <div class="grid grid-cols-2 items-center gap-2 mt-2">
        <label for="bulan-penyalurando" class="text-sm font-medium text-gray-700">Bulan</label>
        <select id="bulan-penyalurando" class="filter-dropdown border border-gray-300 rounded-lg shadow-sm p-2 h-[40px] w-full">
          <option value="">Pilih Bulan</option>
          <option value="1">Januari</option>
          <option value="2">Februari</option>
          <option value="3">Maret</option>
          <option value="4">April</option>
          <option value="5">Mei</option>
          <option value="6">Juni</option>
          <option value="7">Juli</option>
          <option value="8">Agustus</option>
          <option value="9">September</option>
          <option value="10">Oktober</option>
          <option value="11">November</option>
          <option value="12">Desember</option>
        </select>
      </div>

      <div class="grid grid-cols-2 items-center gap-2 mt-2">
        <label for="kabupaten-penyalurando" class="text-sm font-medium text-gray-700">Kabupaten</label>
        <select id="kabupaten-penyalurando" class="filter-dropdown border border-gray-300 rounded-lg shadow-sm p-2 h-[40px] w-full">
          <option value="BANJARNEGARA">BANJARNEGARA</option>
          <option value="BANYUMAS">BANYUMAS</option>
          <option value="BATANG">BATANG</option>
          <option value="BLORA">BLORA</option>
          <option value="BOYOLALI">BOYOLALI</option>
          <option value="BREBES">BREBES</option>
          <option value="CILACAP">CILACAP</option>
          <option value="DEMAK">DEMAK</option>
          <option value="GROBOGAN">GROBOGAN</option>
          <option value="JEPARA">JEPARA</option>
          <option value="KARANGANYAR">KARANGANYAR</option>
          <option value="KEBUMEN">KEBUMEN</option>
          <option value="KENDAL">KENDAL</option>
          <option value="KLATEN">KLATEN</option>
          <option value="KUDUS">KUDUS</option>
          <option value="MAGELANG">MAGELANG</option>
          <option value="PATI">PATI</option>
          <option value="PEKALONGAN">PEKALONGAN</option>
          <option value="PEMALANG">PEMALANG</option>
          <option value="PURBALINGGA">PURBALINGGA</option>
          <option value="PURWOREJO">PURWOREJO</option>
          <option value="REMBANG">REMBANG</option>
          <option value="SEMARANG">SEMARANG</option>
          <option value="SRAGEN">SRAGEN</option>
          <option value="SUKOHARJO">SUKOHARJO</option>
          <option value="TEGAL">TEGAL</option>
          <option value="TEMANGGUNG">TEMANGGUNG</option>
          <option value="WONOGIRI">WONOGIRI</option>
          <option value="WONOSOBO">WONOSOBO</option>
          <option value="KOTA MAGELANG">KOTA MAGELANG</option>
          <option value="KOTA PEKALONGAN">KOTA PEKALONGAN</option>
          <option value="KOTA SALATIGA">KOTA SALATIGA</option>
          <option value="KOTA SEMARANG">KOTA SEMARANG</option>
          <option value="KOTA SURAKARTA">KOTA SURAKARTA</option>
          <option value="KOTA TEGAL">KOTA TEGAL</option>
          <option value="BANTUL">BANTUL</option>
          <option value="KOTA YOGYAKARTA">KOTA YOGYAKARTA</option>
          <option value="SLEMAN">SLEMAN</option>
          <option value="KULON PROGO">KULON PROGO</option>
          <option value="GUNUNG KIDUL">GUNUNG KIDUL</option>
        </select>
      </div>

      <div class="d-flex flex-column gap-2 mt-4">
        <button type="button" class="btn btn-danger" data-jenis="penyalurando">Hapus Data Penyaluran DO</button>
      </div>
    </div>

    <div id="wcm" class="tab-content">
      <h5>Hapus Data WCM</h5>
      <p class="text-muted">Fitur ini belum aktif.</p>
    </div>
  </div>
</div>


      <%- include('./partials/footer'); %>
    </div>

    <!-- Core JS -->
    <script src="./assets/js/core/jquery-3.7.1.min.js"></script>
    <script src="./assets/js/core/bootstrap.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>


    <script>
  // Script Tab Logic
  $('.tab-btn').on('click', function () {
    $('.tab-btn').removeClass('active');
    $(this).addClass('active');

    const target = $(this).data('target');
    $('.tab-content').removeClass('active');
    $('#' + target).addClass('active');
  });

  // Script Delete Universal
  $(document).ready(function () {
  $('.btn-danger').on('click', function () {
    const jenis = $(this).data('jenis'); // e.g. 'verval' atau 'penyaluran_do'

    // Pastikan nilai 'jenis' tidak kosong
    if (!jenis) {
      return Swal.fire('Error', 'Jenis data tidak ditemukan pada tombol!', 'error');
    }

    // Ambil input berdasarkan ID yang dibentuk dari jenis
    const manajer = $(`#manajer-${jenis}`).val();
    const tahun = $(`#tahun-${jenis}`).val();
    const bulan = $(`#bulan-${jenis}`).val();
    const kabupaten = $(`#kabupaten-${jenis}`).val();

    if (!manajer || !tahun || !bulan) {
      return Swal.fire('Peringatan', 'Wilayah, Tahun, dan bulan wajib diisi!', 'warning');
    }

    // Label untuk konfirmasi
    let jenisLabel = '';
    if (jenis === 'verval') jenisLabel = 'Verval';
    else if (jenis === 'penyalurando') jenisLabel = 'Penyaluran DO';
    else jenisLabel = 'Data';

    // Konfirmasi sebelum hapus
    Swal.fire({
      title: 'Apakah Anda yakin?',
      text: `Data ${jenisLabel} untuk ${kabupaten || 'semua kabupaten'} bulan ${bulan} tahun ${tahun} akan dihapus!`,
      icon: 'warning',
      showCancelButton: true,
      confirmButtonColor: '#d33',
      cancelButtonColor: '#aaa',
      confirmButtonText: 'Ya, hapus data!'
    }).then((result) => {
      if (result.isConfirmed) {
        $.ajax({
          url: `/delete/delete-${jenis}`,
          method: 'POST',
          contentType: 'application/json',
          data: JSON.stringify({ tahun, bulan, kabupaten }),
          success: function (res) {
            Swal.fire('Berhasil', res.message || 'Data berhasil dihapus', 'success');
          },
          error: function (err) {
            Swal.fire('Gagal', err.responseJSON?.message || 'Terjadi kesalahan saat menghapus data.', 'error');
          }
        });
      }
    });
  });
});
</script>

  </body>
</html>
